<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
<title>Theme Studio ‚Äî Mobile</title>
<style>
:root{
  --brand:#8200c8;--brandHover:#3d007a;--link:#8200c8;
  --text:#cbadff;--muted:#72767d;--textPrimary:#e9d9ff;--textSecond:#d79dff;
  --bgPrimary:#0f0f10;--bgSecondary:#121214;--bgAlt:#1a1a1e;--bgTertiary:#0c0c0e;
  --bgFloating:#18181b;--bgNested:#0e0e10;
  --cardPrimary:#0e0e10;--cardSecondary:#0f0f12;--input:#121214;
  --success:#3ba55c;--warning:#faa61a;--danger:#ed4245;
  --ripple:#5b2a82;--scrollbar:#2b2b2b;--mentionLine:#b592e6;
  --icon:#cbadff;--iconMuted:#8a8a8a;
  --fabBg:#5865f2;
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;background:#000;color:var(--text);font:14px/1.4 'Inter',system-ui,-apple-system,sans-serif;overflow:hidden;-webkit-tap-highlight-color:transparent}
button{font:inherit;cursor:pointer;border:none;background:none;color:inherit}
input{font:inherit;color:inherit;background:none;border:none;outline:none}

.app{height:100vh;height:100dvh;display:flex;flex-direction:column}

.topToggle{display:flex;align-items:center;justify-content:space-between;padding:8px 12px;background:var(--bgSecondary);border-bottom:1px solid rgba(255,255,255,.06);flex-shrink:0}
.topToggle h1{font-size:14px;font-weight:800;color:var(--textPrimary)}
.toggleBtn{padding:6px 14px;border-radius:999px;font-size:12px;font-weight:700;background:var(--brand);color:#fff}

.mainArea{flex:1;overflow:auto;position:relative}

.phoneWrap{height:100%;display:flex;background:#000}

.rail{width:64px;flex-shrink:0;background:var(--bgTertiary);padding:10px 0;display:flex;flex-direction:column;align-items:center;gap:8px;overflow-y:auto;-ms-overflow-style:none;scrollbar-width:none}
.rail::-webkit-scrollbar{display:none}
.srv{width:48px;height:48px;border-radius:16px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:18px;color:#fff;cursor:pointer;transition:border-radius .2s,background .2s;overflow:hidden;flex-shrink:0}
.srv:hover{border-radius:12px}
.srv.active{border-radius:12px}
.srv img{width:100%;height:100%;object-fit:cover}
.srv.dm{background:var(--brand);border-radius:16px}
.railLabel{font-size:9px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.04em;margin-top:4px;text-align:center;padding:0 4px;width:100%}
.railSep{width:32px;height:2px;border-radius:1px;background:rgba(255,255,255,.06);flex-shrink:0}

.content{flex:1;display:flex;flex-direction:column;min-width:0;background:var(--bgPrimary)}

.header{padding:14px 16px 0;flex-shrink:0}
.header h2{font-size:24px;font-weight:800;color:#fff;margin-bottom:12px}
.searchRow{display:flex;gap:8px;align-items:center;margin-bottom:14px}
.searchBtn{width:40px;height:40px;border-radius:12px;background:var(--bgAlt);display:flex;align-items:center;justify-content:center;flex-shrink:0}
.searchBtn svg{width:18px;height:18px;fill:var(--muted)}
.addFriends{flex:1;height:40px;border-radius:12px;background:var(--bgAlt);display:flex;align-items:center;justify-content:center;gap:6px;font-size:14px;font-weight:600;color:var(--muted)}
.addFriends svg{width:18px;height:18px;fill:var(--muted)}

.featured{display:flex;gap:10px;padding:0 0 14px;overflow-x:auto;-ms-overflow-style:none;scrollbar-width:none}
.featured::-webkit-scrollbar{display:none}
.featCard{min-width:160px;height:100px;border-radius:14px;background:var(--bgAlt);overflow:hidden;flex-shrink:0;position:relative;display:flex;flex-direction:column;justify-content:flex-end;padding:10px}
.featCard .featName{font-weight:700;font-size:14px;color:#fff;position:relative;z-index:1}
.featCard .featDesc{font-size:11px;color:rgba(255,255,255,.6);position:relative;z-index:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}

.dmList{flex:1;overflow-y:auto;padding:0 0 80px}
.dm{display:flex;gap:12px;align-items:center;padding:10px 16px;transition:background .15s}
.dm:active{background:rgba(255,255,255,.04)}
.dmAva{width:40px;height:40px;border-radius:50%;flex-shrink:0;position:relative;overflow:visible}
.dmAva .avaImg{width:40px;height:40px;border-radius:50%;object-fit:cover;background:linear-gradient(135deg,var(--bgAlt),var(--bgFloating))}
.dmAva .statusDot{position:absolute;bottom:-1px;right:-1px;width:14px;height:14px;border-radius:50%;border:3px solid var(--bgPrimary)}
.statusDot.online{background:var(--success)}
.statusDot.idle{background:var(--warning)}
.statusDot.dnd{background:var(--danger)}
.statusDot.offline{background:var(--muted)}
.dmInfo{flex:1;min-width:0}
.dmTop{display:flex;align-items:baseline;gap:6px}
.dmName{font-weight:700;font-size:15px;color:#fff;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.dmBadge{font-size:11px;padding:1px 5px;border-radius:4px;background:rgba(255,255,255,.1);color:var(--textSecond);flex-shrink:0;white-space:nowrap}
.dmTime{margin-left:auto;font-size:12px;color:var(--muted);flex-shrink:0}
.dmMsg{font-size:13px;color:var(--muted);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-top:2px}
.dmStar{color:var(--warning);margin-left:auto;flex-shrink:0;font-size:12px}

.fab{position:fixed;bottom:68px;right:16px;width:52px;height:52px;border-radius:50%;background:var(--fabBg);display:flex;align-items:center;justify-content:center;box-shadow:0 4px 16px rgba(0,0,0,.4);z-index:10}
.fab svg{width:24px;height:24px;fill:#fff}

.bottomNav{position:fixed;bottom:0;left:0;right:0;height:56px;background:var(--bgSecondary);border-top:1px solid rgba(255,255,255,.06);display:flex;align-items:center;justify-content:space-around;z-index:10;padding-bottom:env(safe-area-inset-bottom)}
.navItem{display:flex;flex-direction:column;align-items:center;gap:2px;font-size:10px;font-weight:600;color:var(--muted);padding:4px 16px;cursor:pointer;-webkit-tap-highlight-color:transparent}
.navItem.active{color:#fff}
.navItem svg{width:22px;height:22px;fill:currentColor}
.navItem .youAva{width:24px;height:24px;border-radius:50%;background:var(--bgAlt);border:2px solid transparent;position:relative}
.navItem.active .youAva{border-color:#fff}
.youAva .onlineDot{position:absolute;bottom:-2px;right:-2px;width:10px;height:10px;border-radius:50%;background:var(--success);border:2px solid var(--bgSecondary)}

/* Notifications */
.notifPage{flex:1;display:flex;flex-direction:column;background:var(--bgPrimary);min-height:0}
.notifHeader{padding:14px 16px;display:flex;align-items:center;justify-content:space-between;flex-shrink:0}
.notifHeader h2{font-size:24px;font-weight:800;color:#fff}
.notifDots{width:36px;height:36px;border-radius:50%;background:var(--bgAlt);display:flex;align-items:center;justify-content:center;font-size:18px;color:var(--muted);cursor:pointer}
.notifSep{height:1px;background:rgba(255,255,255,.06);margin:0 16px}
.notifSection{font-size:12px;font-weight:700;color:var(--muted);padding:12px 16px 8px;text-transform:uppercase;letter-spacing:.04em}
.notifList{flex:1;overflow-y:auto;padding-bottom:80px}
.notifItem{display:flex;gap:12px;padding:12px 16px;align-items:flex-start}
.notifItem:active{background:rgba(255,255,255,.04)}
.notifAva{width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--bgAlt),var(--bgFloating));flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:20px}
.notifBody{flex:1;min-width:0}
.notifText{font-size:14px;color:var(--text);line-height:1.4}
.notifText b{color:#fff;font-weight:700}
.notifQuote{margin-top:4px;padding-left:10px;border-left:3px solid var(--mentionLine);font-size:13px;color:var(--muted)}
.notifTime{font-size:12px;color:var(--muted);flex-shrink:0;margin-top:2px}

/* Profile */
.profilePage{flex:1;display:flex;flex-direction:column;background:var(--bgPrimary);overflow-y:auto;padding-bottom:80px}
.profileBanner{height:120px;background:linear-gradient(135deg,#1a0030,#0a0a15);position:relative;flex-shrink:0}
.profileAvaWrap{position:absolute;bottom:-40px;left:20px}
.profileAva{width:88px;height:88px;border-radius:50%;background:linear-gradient(135deg,var(--bgAlt),var(--bgFloating));border:4px solid var(--bgPrimary);display:flex;align-items:center;justify-content:center;font-size:36px}
.profileStatusDot{position:absolute;bottom:4px;right:4px;width:20px;height:20px;border-radius:50%;background:var(--success);border:4px solid var(--bgPrimary)}
.profileInfo{padding:52px 20px 0}
.profileName{font-size:26px;font-weight:800;color:#fff}
.profileHandle{font-size:14px;color:var(--muted);margin-top:2px}
.profilePronouns{font-size:13px;color:var(--textSecond);margin-top:2px}
.profileBadges{display:flex;gap:6px;margin-top:10px;flex-wrap:wrap}
.profileBadge{width:28px;height:28px;border-radius:50%;background:var(--bgAlt);display:flex;align-items:center;justify-content:center;font-size:14px}
.profileEditBtn{margin:16px 20px;padding:12px;border-radius:12px;background:var(--brand);color:#fff;font-weight:700;font-size:15px;text-align:center;cursor:pointer}
.profileCard{margin:8px 20px;background:var(--cardPrimary);border-radius:14px;padding:16px;border:1px solid rgba(255,255,255,.06)}
.profileCardTitle{font-size:13px;font-weight:700;color:var(--muted);margin-bottom:8px}
.profileCardValue{font-size:15px;color:#fff;font-weight:600;display:flex;align-items:center;gap:8px}
.profileAbout{font-size:14px;color:var(--text);line-height:1.6;white-space:pre-line}
.profileMemberSince{margin-top:12px;font-size:13px;color:var(--muted)}
.profileMemberSince span{color:var(--text)}

.controls{padding:16px;background:var(--bgPrimary)}
.controls h1{font-size:18px;font-weight:800;color:var(--textPrimary);margin-bottom:2px}
.controls .sub{font-size:11px;color:var(--muted);margin-bottom:12px}
.toolbar{display:flex;gap:6px;flex-wrap:wrap;align-items:center;margin-bottom:12px}
.presetBtn{padding:6px 10px;border-radius:8px;font-size:11px;font-weight:700}
.presetBtn.primary{background:var(--brand);color:#fff}
.presetBtn.sec{background:var(--bgAlt);color:var(--text);border:1px solid rgba(255,255,255,.08)}
.presetBtn.ghost{color:var(--text)}
.section{margin-bottom:16px}
.section h2{font-size:10px;text-transform:uppercase;letter-spacing:.08em;color:var(--muted);margin-bottom:8px;font-weight:700}
.field{display:flex;align-items:center;gap:8px;border:1px solid rgba(255,255,255,.06);border-radius:10px;padding:8px;margin-bottom:6px;background:var(--bgSecondary)}
.field .fLabel{flex:1;min-width:0}
.field .fLabel span{display:block;font-size:12px;font-weight:700;color:var(--text)}
.field .fLabel small{font-size:10px;color:var(--muted)}
.field input[type="color"]{width:36px;height:36px;border-radius:8px;border:1px solid rgba(255,255,255,.12);background:transparent;padding:0;cursor:pointer}
.field input[type="text"]{width:72px;padding:6px 8px;border-radius:6px;border:1px solid rgba(255,255,255,.08);background:var(--bgAlt);color:var(--text);font-size:11px;font-family:monospace}
.exportSection{margin-top:12px}
.exportBtns{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:8px}
.exportTextarea{width:100%;min-height:100px;background:var(--bgSecondary);color:#d5d6db;border:1px solid rgba(255,255,255,.08);border-radius:10px;padding:8px;font:11px/1.4 monospace;resize:vertical}
.exportHint{font-size:10px;color:var(--muted);margin-top:6px}
.exportHint b{color:var(--text)}
.collapsible{cursor:pointer;display:flex;align-items:center;gap:4px;user-select:none}
.collapsible::before{content:'‚ñ∏';font-size:10px;transition:transform .2s}
.collapsible.open::before{transform:rotate(90deg)}
.advPanel{display:none;margin-top:6px}
.advPanel.show{display:block}
.advRow{display:flex;gap:4px;align-items:center;margin-bottom:4px}
.advRow input[type="text"]{flex:1;padding:5px 6px;border-radius:6px;border:1px solid rgba(255,255,255,.08);background:var(--bgAlt);color:var(--text);font-size:11px;font-family:monospace}
.advRow .advDel{width:24px;height:24px;border-radius:6px;background:var(--danger);color:#fff;display:flex;align-items:center;justify-content:center;font-size:14px;cursor:pointer;flex-shrink:0}
.advAdd{display:flex;gap:4px;margin-top:4px}
.advAdd input{flex:1;padding:5px 6px;border-radius:6px;border:1px solid rgba(255,255,255,.08);background:var(--bgAlt);color:var(--text);font-size:11px;font-family:monospace}
.advAdd button{padding:5px 10px;border-radius:6px;background:var(--brand);color:#fff;font-size:11px;font-weight:700}
.toggleSwitch{position:relative;width:40px;height:22px;background:var(--bgAlt);border-radius:11px;cursor:pointer;transition:background .2s;flex-shrink:0}
.toggleSwitch.on{background:var(--brand)}
.toggleSwitch::after{content:'';position:absolute;top:2px;left:2px;width:18px;height:18px;border-radius:50%;background:#fff;transition:transform .2s}
.toggleSwitch.on::after{transform:translateX(18px)}

.toast{position:fixed;left:50%;bottom:80px;transform:translateX(-50%);background:var(--bgFloating);color:var(--text);border:1px solid rgba(255,255,255,.1);border-radius:10px;padding:10px 16px;box-shadow:0 8px 24px rgba(0,0,0,.5);opacity:0;transition:opacity .2s;pointer-events:none;z-index:100;font-size:13px;font-weight:600;white-space:nowrap}
.toast.show{opacity:1}
</style>
</head>
<body>

<div class="app" id="app">
  <div class="topToggle">
    <h1>Mobile Theme Studio</h1>
    <button class="toggleBtn" id="modeBtn" onclick="toggleMode()">Edit Colors</button>
  </div>
  <div class="mainArea" id="mainArea"></div>
</div>
<div class="toast" id="toast"></div>

<script>
const PRESETS={
  purple:{brand:"#8200c8",brandHover:"#3d007a",link:"#8200c8",text:"#cbadff",muted:"#72767d",textPrimary:"#e9d9ff",textSecond:"#d79dff",bgPrimary:"#0f0f10",bgSecondary:"#121214",bgAlt:"#1a1a1e",bgTertiary:"#0c0c0e",bgFloating:"#18181b",bgNested:"#0e0e10",cardPrimary:"#0e0e10",cardSecondary:"#0f0f12",input:"#121214",success:"#3ba55c",warning:"#faa61a",danger:"#ed4245",ripple:"#5b2a82",scrollbar:"#2b2b2b",mentionLine:"#b592e6",icon:"#cbadff",iconMuted:"#8a8a8a",fabBg:"#5865f2"},
  cobalt:{brand:"#0066cc",brandHover:"#003d7a",link:"#3399ff",text:"#a8c7e6",muted:"#5599cc",textPrimary:"#d6e8f5",textSecond:"#88b8dd",bgPrimary:"#0a0e14",bgSecondary:"#0c1018",bgAlt:"#111822",bgTertiary:"#080c12",bgFloating:"#0c1119",bgNested:"#090d13",cardPrimary:"#090d13",cardSecondary:"#0c1119",input:"#0c1018",success:"#3ba55c",warning:"#faa61a",danger:"#cc3333",ripple:"#1a4080",scrollbar:"#1a2840",mentionLine:"#5599cc",icon:"#a8c7e6",iconMuted:"#556677",fabBg:"#0066cc"},
  default:{brand:"#5865f2",brandHover:"#4752c4",link:"#00aff4",text:"#dcddde",muted:"#72767d",textPrimary:"#ffffff",textSecond:"#b9bbbe",bgPrimary:"#36393f",bgSecondary:"#2f3136",bgAlt:"#3a3d44",bgTertiary:"#202225",bgFloating:"#18191c",bgNested:"#2f3136",cardPrimary:"#2f3136",cardSecondary:"#292b2f",input:"#40444b",success:"#3ba55c",warning:"#faa61a",danger:"#ed4245",ripple:"#4752c4",scrollbar:"#202225",mentionLine:"#5865f2",icon:"#b9bbbe",iconMuted:"#72767d",fabBg:"#5865f2"}
};

const COLOR_META={
  brand:{l:"Brand",h:"Primary accent"},brandHover:{l:"Brand Hover",h:"Hover state"},link:{l:"Link",h:"Hyperlinks"},
  text:{l:"Text",h:"Default text"},muted:{l:"Muted",h:"Secondary text"},textPrimary:{l:"Text Primary",h:"Headings"},textSecond:{l:"Text Secondary",h:"Timestamps"},
  bgPrimary:{l:"BG Primary",h:"Main background"},bgSecondary:{l:"BG Secondary",h:"Secondary surface"},bgAlt:{l:"BG Alt",h:"Cards / rows"},bgTertiary:{l:"BG Tertiary",h:"Deepest bg"},bgFloating:{l:"BG Floating",h:"Floating panels"},bgNested:{l:"BG Nested",h:"Nested containers"},
  cardPrimary:{l:"Card Primary",h:"Card bg"},cardSecondary:{l:"Card Secondary",h:"Card alt"},input:{l:"Input",h:"Input bg"},
  success:{l:"Success",h:"Online"},warning:{l:"Warning",h:"Idle"},danger:{l:"Danger",h:"DND / error"},
  ripple:{l:"Ripple",h:"Touch ripple"},scrollbar:{l:"Scrollbar",h:"Scroll thumb"},mentionLine:{l:"Mention",h:"Mention bar"},
  icon:{l:"Icon",h:"Icon color"},iconMuted:{l:"Icon Muted",h:"Dim icons"},fabBg:{l:"FAB",h:"New DM button"}
};

let colors={...PRESETS.purple};
let mode="preview";
let activeTab="home";
let themeMeta={name:"Theme Name",description:"Theme Description",version:"3",authorName:"Matko802",authorId:"1052216205542428698",spec:2};
let themeExtra={semanticColors:{},rawColors:{},background:null,plus:{version:"0",iconPack:"",customOverlays:false,icons:{}},other:{}};

function applyColors(){
  const r=document.documentElement.style;
  for(const[k,v]of Object.entries(colors)){r.setProperty('--'+k,v)}
}
function camelToKebab(s){return s.replace(/([A-Z])/g,'-$1').toLowerCase()}

function showToast(msg){
  const t=document.getElementById('toast');
  t.textContent=msg;t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),1800);
}

const DMS=[
  {name:"Matko802",badge:"",status:"online",msg:"Vibecoded but atleast it works",time:"1h",star:true}
];

const SERVERS=[
  {letter:"üí¨",type:"dm",bg:"var(--brand)"},
  {img: "https://raw.githubusercontent.com/C0C0B01/Kettu/github/src/assets/icons/kettu.png", bg:"#000000"},
];

const NOTIFICATIONS=[
  {user:"Discord",text:"</b>",quote:"give us your id :)",time:"16h",emoji:"‚ùì"}
];

function switchTab(tab){
  activeTab=tab;
  render();
}

function toggleMode(){
  mode=mode==="preview"?"edit":"preview";
  document.getElementById('modeBtn').textContent=mode==="preview"?"Edit Colors":"Preview";
  render();
}

function render(){
  const area=document.getElementById('mainArea');
  if(mode==="preview"){
    area.innerHTML=renderPreview();
  }else{
    area.innerHTML=renderControls();
    bindControls();
  }
  applyColors();
}

function renderBottomNav(){
  return `
  <div class="bottomNav">
    <div class="navItem ${activeTab==='home'?'active':''}" onclick="switchTab('home')">
      <svg viewBox="0 0 24 24"><path d="M4 4h7V2H2v9h2V4zm0 16h7v2H2v-9h2v7zm16 0h-7v2h9v-9h-2v7zM20 4h-7V2h9v9h-2V4zM8.5 9A1.5 1.5 0 0110 7.5h4A1.5 1.5 0 0115.5 9v1h.5a1 1 0 011 1v4a1 1 0 01-1 1H8a1 1 0 01-1-1v-4a1 1 0 011-1h.5V9z"/></svg>
      Home
    </div>
    <div class="navItem ${activeTab==='notif'?'active':''}" onclick="switchTab('notif')">
      <svg viewBox="0 0 24 24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>
      Notifications
    </div>
    <div class="navItem ${activeTab==='you'?'active':''}" onclick="switchTab('you')">
      <div class="youAva"><div class="onlineDot"></div></div>
      You
    </div>
  </div>`;
}

function renderPreview(){
  let tabContent='';
  if(activeTab==='home'){
    tabContent=renderHome();
  }else if(activeTab==='notif'){
    tabContent=renderNotifications();
  }else{
    tabContent=renderProfile();
  }
  return tabContent + (activeTab==='home'?`<div class="fab"><svg viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12zM7 9h2v2H7zm4 0h2v2h-2zm4 0h2v2h-2z"/></svg></div>`:'') + renderBottomNav();
}

function renderHome(){
  return `
  <div class="phoneWrap">
    <div class="rail">
      ${SERVERS.map((s,i)=>{
        if(s.label) return '<div class="railLabel">'+s.label+'</div>';
        const content = s.img ? `<img src="${s.img}" alt="Kettu Logo">` : s.letter;
        return '<div class="srv '+(i===0?'active':'')+'" style="background:'+(s.bg||'transparent')+'">'+content+'</div>'+(i===0?'<div class="railSep"></div>':'');
      }).join('')}
    </div>
    <div class="content">
      <div class="header">
        <h2>Messages</h2>
        <div class="searchRow">
          <div class="searchBtn"><svg viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27A6.47 6.47 0 0015.91 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.48l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg></div>
          <div class="addFriends"><svg viewBox="0 0 24 24"><path d="M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>Add Friends</div>
        </div>
        <div class="featured">
          <div class="featCard" style="background:linear-gradient(135deg,#1a1a2e,#16213e)">
            <div class="featName">Gaming</div>
            <div class="featDesc">"The waves‚Ä¶ will lay‚Ä¶"</div>
          </div>
          <div class="featCard" style="background:linear-gradient(135deg,#2d1b1b,#1a1212)">
            <div class="featName">Memes</div>
            <div class="featDesc">Latest hot memes üî•</div>
          </div>
        </div>
      </div>
      <div class="dmList">
        ${DMS.map(dm=>`
          <div class="dm">
            <div class="dmAva">
              <div class="avaImg"></div>
              <div class="statusDot ${dm.status}"></div>
            </div>
            <div class="dmInfo">
              <div class="dmTop">
                <span class="dmName">${dm.name}</span>
                ${dm.badge?'<span class="dmBadge">'+dm.badge+'</span>':''}
                ${dm.star?'<span class="dmStar">‚òÖ</span>':''}
                <span class="dmTime">${dm.time}</span>
              </div>
              <div class="dmMsg">${dm.msg}</div>
            </div>
          </div>
        `).join('')}
      </div>
    </div>
  </div>`;
}

function renderNotifications(){
  return `
  <div class="notifPage">
    <div class="notifHeader">
      <h2>Notifications</h2>
      <div class="notifDots">‚Ä¢‚Ä¢‚Ä¢</div>
    </div>
    <div class="notifSep"></div>
    <div class="notifSection">Recent Activity</div>
    <div class="notifList">
      ${NOTIFICATIONS.map(n=>`
        <div class="notifItem">
          <div class="notifAva">${n.emoji}</div>
          <div class="notifBody">
            <div class="notifText"><b>${n.user}</b> ${n.text}</div>
            <div class="notifQuote">${n.quote}</div>
          </div>
          <div class="notifTime">${n.time}</div>
        </div>
      `).join('')}
    </div>
  </div>`;
}

function renderProfile(){
  return `
  <div class="profilePage">
    <div class="profileBanner">
      <div class="profileAvaWrap">
        <div class="profileAva">‚ùì</div>
        <div class="profileStatusDot"></div>
      </div>
    </div>
    <div class="profileInfo">
      <div class="profileName">Matko802</div>
      <div class="profileHandle">matko802 ¬∑ He/Them</div>
      <div class="profileBadges">
        <div class="profileBadge">üíé</div>
        <div class="profileBadge">#</div>
        <div class="profileBadge">üëª</div>
        <div class="profileBadge">üí†</div>
      </div>
    </div>
    <div class="profileEditBtn">‚úèÔ∏è Edit Profile</div>
    <div class="profileCard">
      <div class="profileCardTitle">Orbs Balance</div>
      <div class="profileCardValue">üí† 0</div>
    </div>
    <div class="profileCard">
      <div class="profileCardTitle">About Me</div>
      <div class="profileAbout">Placeholder text</div>
      <div class="profileMemberSince">Member Since<br><span>üéÆ 13 Dec 2022</span></div>
    </div>
    <div class="profileCard">
      <div class="profileCardTitle">Connections</div>
      <div class="profileCardValue"><a href="https://matko.felixhub.dev/" target="_blank" style="color:inherit;text-decoration:none;">üåê matko.felixhub.dev</a></div>
    </div>
  </div>`;
}

function renderControls(){
  const keys=Object.keys(COLOR_META);
  const scKeys=Object.keys(themeExtra.semanticColors);
  const rcKeys=Object.keys(themeExtra.rawColors);
  const plusIcons=themeExtra.plus.icons||{};
  const piKeys=Object.keys(plusIcons);
  return `
  <div class="controls">
    <h1>Theme Studio ‚Äî Mobile</h1>
    <div class="sub">Edit colors and export your theme JSON (Vendetta/Bunny format)</div>
    <div class="toolbar">
      <button class="presetBtn primary" onclick="loadPreset('purple')">Purple Vision</button>
      <button class="presetBtn sec" onclick="loadPreset('cobalt')">Cobalt</button>
      <button class="presetBtn ghost" onclick="loadPreset('default')">Default</button>
    </div>

    <div class="section">
      <h2>Theme Info</h2>
      <div class="field">
        <div class="fLabel"><span>Name</span><small>Theme name</small></div>
        <input type="text" value="${themeMeta.name}" style="width:140px" onchange="themeMeta.name=this.value"/>
      </div>
      <div class="field">
        <div class="fLabel"><span>Description</span><small>Short description</small></div>
        <input type="text" value="${themeMeta.description}" style="width:140px" onchange="themeMeta.description=this.value"/>
      </div>
      <div class="field">
        <div class="fLabel"><span>Author</span><small>Your name</small></div>
        <input type="text" value="${themeMeta.authorName}" style="width:100px" onchange="themeMeta.authorName=this.value"/>
      </div>
      <div class="field">
        <div class="fLabel"><span>Author ID</span><small>Discord user ID</small></div>
        <input type="text" value="${themeMeta.authorId}" style="width:140px" onchange="themeMeta.authorId=this.value"/>
      </div>
      <div class="field">
        <div class="fLabel"><span>Version</span><small>Theme version</small></div>
        <input type="text" value="${themeMeta.version}" style="width:60px" onchange="themeMeta.version=this.value"/>
      </div>
      <div class="field">
        <div class="fLabel"><span>Spec</span><small>Format spec (2)</small></div>
        <input type="text" value="${themeMeta.spec}" style="width:60px" onchange="themeMeta.spec=parseInt(this.value)||2"/>
      </div>
    </div>

    <div class="section">
      <h2>Colors</h2>
      ${keys.map(k=>`
        <div class="field">
          <div class="fLabel"><span>${COLOR_META[k].l}</span><small>${COLOR_META[k].h}</small></div>
          <input type="color" value="${colors[k].substring(0,7)}" data-key="${k}" onchange="updateColor(this)"/>
          <input type="text" value="${colors[k]}" data-key="${k}" onchange="updateColorText(this)"/>
        </div>
      `).join('')}
    </div>

    <div class="section">
      <h2>Background Image</h2>
      <div class="field">
        <div class="fLabel"><span>BG URL</span><small>Background image URL</small></div>
        <input type="text" value="${themeExtra.background&&themeExtra.background.url?themeExtra.background.url:''}" style="width:180px" onchange="setBgUrl(this.value)" placeholder="https://..."/>
      </div>
      <div class="field">
        <div class="fLabel"><span>Blur</span><small>Blur radius</small></div>
        <input type="text" value="${themeExtra.background&&themeExtra.background.blur!=null?themeExtra.background.blur:''}" style="width:60px" onchange="setBgBlur(this.value)" placeholder="0"/>
      </div>
      <div class="field">
        <div class="fLabel"><span>Alpha</span><small>Overlay opacity 0-1</small></div>
        <input type="text" value="${themeExtra.background&&themeExtra.background.alpha!=null?themeExtra.background.alpha:''}" style="width:60px" onchange="setBgAlpha(this.value)" placeholder="0.7"/>
      </div>
    </div>

    <div class="section">
      <h2>Plus Section</h2>
      <div class="field">
        <div class="fLabel"><span>Icon Pack</span><small>e.g. rosiecord-plumpy</small></div>
        <input type="text" value="${themeExtra.plus.iconPack||''}" style="width:140px" onchange="themeExtra.plus.iconPack=this.value||undefined"/>
      </div>
      <div class="field">
        <div class="fLabel"><span>Custom Overlays</span><small>Enable custom overlays</small></div>
        <div class="toggleSwitch ${themeExtra.plus.customOverlays?'on':''}" onclick="togglePlusOverlays(this)"></div>
      </div>
      <div class="field">
        <div class="fLabel"><span>Plus Version</span><small>Plus section version</small></div>
        <input type="text" value="${themeExtra.plus.version||'0'}" style="width:60px" onchange="themeExtra.plus.version=this.value"/>
      </div>
      <h2 class="collapsible" onclick="toggleAdv(this)" style="margin-top:8px">Plus Icons (${piKeys.length})</h2>
      <div class="advPanel">
        ${piKeys.map(k=>`
          <div class="advRow">
            <input type="text" value="${k}" disabled style="flex:1.2"/>
            <input type="color" value="${(plusIcons[k]||'#ffffff').substring(0,7)}" onchange="themeExtra.plus.icons['${k}']=this.value;this.nextElementSibling.value=this.value"/>
            <input type="text" value="${plusIcons[k]||''}" style="width:72px" onchange="themeExtra.plus.icons['${k}']=this.value"/>
            <div class="advDel" onclick="delete themeExtra.plus.icons['${k}'];render()">√ó</div>
          </div>
        `).join('')}
        <div class="advAdd">
          <input type="text" id="piKeyIn" placeholder="Icon name"/>
          <input type="text" id="piValIn" placeholder="#ff0000"/>
          <button onclick="addPlusIcon()">Add</button>
        </div>
      </div>
    </div>

    <div class="section">
      <h2 class="collapsible" onclick="toggleAdv(this)">Semantic Color Overrides (${scKeys.length})</h2>
      <div class="advPanel">
        <div class="exportHint" style="margin-bottom:6px">Override any semanticColor key. Values are arrays ‚Äî enter the dark mode hex.</div>
        ${scKeys.map(k=>`
          <div class="advRow">
            <input type="text" value="${k}" disabled style="flex:1.5"/>
            <input type="text" value="${Array.isArray(themeExtra.semanticColors[k])?themeExtra.semanticColors[k][0]:themeExtra.semanticColors[k]}" style="width:80px" onchange="themeExtra.semanticColors['${k}']=[this.value]"/>
            <div class="advDel" onclick="delete themeExtra.semanticColors['${k}'];render()">√ó</div>
          </div>
        `).join('')}
        <div class="advAdd">
          <input type="text" id="scKeyIn" placeholder="SEMANTIC_KEY"/>
          <input type="text" id="scValIn" placeholder="#hexvalue"/>
          <button onclick="addScOverride()">Add</button>
        </div>
      </div>
    </div>

    <div class="section">
      <h2 class="collapsible" onclick="toggleAdv(this)">Raw Color Overrides (${rcKeys.length})</h2>
      <div class="advPanel">
        <div class="exportHint" style="margin-bottom:6px">Override any rawColor key directly.</div>
        ${rcKeys.map(k=>`
          <div class="advRow">
            <input type="text" value="${k}" disabled style="flex:1.5"/>
            <input type="text" value="${themeExtra.rawColors[k]}" style="width:80px" onchange="themeExtra.rawColors['${k}']=this.value"/>
            <div class="advDel" onclick="delete themeExtra.rawColors['${k}'];render()">√ó</div>
          </div>
        `).join('')}
        <div class="advAdd">
          <input type="text" id="rcKeyIn" placeholder="RAW_KEY"/>
          <input type="text" id="rcValIn" placeholder="#hexvalue"/>
          <button onclick="addRcOverride()">Add</button>
        </div>
      </div>
    </div>

    <div class="section exportSection">
      <h2>Import / Export</h2>
      <div class="exportBtns">
        <button class="presetBtn primary" onclick="copyJSON()">Copy JSON</button>
        <button class="presetBtn sec" onclick="downloadJSON()">Download</button>
        <button class="presetBtn ghost" onclick="openFile()">Open File</button>
      </div>
      <textarea class="exportTextarea" id="jsonArea" placeholder="Paste theme JSON here to import‚Ä¶"></textarea>
      <button class="presetBtn sec" onclick="importJSON()" style="margin-top:6px">Import</button>
      <div class="exportHint">Export uses <b>Vendetta/Bunny</b> JSON format with semanticColors + rawColors.</div>
    </div>
  </div>`;
}

function bindControls(){}

function toggleAdv(el){
  el.classList.toggle('open');
  const panel=el.nextElementSibling;
  if(panel)panel.classList.toggle('show');
}
function togglePlusOverlays(el){
  themeExtra.plus.customOverlays=!themeExtra.plus.customOverlays;
  el.classList.toggle('on');
}
function setBgUrl(v){
  if(!v){themeExtra.background=null;return;}
  if(!themeExtra.background)themeExtra.background={};
  themeExtra.background.url=v;
}
function setBgBlur(v){
  if(!themeExtra.background)themeExtra.background={};
  themeExtra.background.blur=v?parseFloat(v):undefined;
}
function setBgAlpha(v){
  if(!themeExtra.background)themeExtra.background={};
  themeExtra.background.alpha=v?parseFloat(v):undefined;
}
function addScOverride(){
  const k=document.getElementById('scKeyIn')?.value?.trim();
  const v=document.getElementById('scValIn')?.value?.trim();
  if(!k||!v)return showToast('Enter key and value');
  themeExtra.semanticColors[k]=[v];render();showToast('Added '+k);
}
function addRcOverride(){
  const k=document.getElementById('rcKeyIn')?.value?.trim();
  const v=document.getElementById('rcValIn')?.value?.trim();
  if(!k||!v)return showToast('Enter key and value');
  themeExtra.rawColors[k]=v;render();showToast('Added '+k);
}
function addPlusIcon(){
  const k=document.getElementById('piKeyIn')?.value?.trim();
  const v=document.getElementById('piValIn')?.value?.trim();
  if(!k||!v)return showToast('Enter icon name and color');
  if(!themeExtra.plus.icons)themeExtra.plus.icons={};
  themeExtra.plus.icons[k]=v;render();showToast('Added '+k);
}

function updateColor(el){
  const k=el.dataset.key;colors[k]=el.value;
  const txt=el.parentElement.querySelector('input[type="text"]');
  if(txt)txt.value=el.value;applyColors();
}
function updateColorText(el){
  const k=el.dataset.key;
  if(/^#[0-9a-fA-F]{3,8}$/.test(el.value)){
    colors[k]=el.value;
    const col=el.parentElement.querySelector('input[type="color"]');
    if(col)col.value=el.value;applyColors();
  }
}
function loadPreset(name){colors={...PRESETS[name]};render();showToast(name.charAt(0).toUpperCase()+name.slice(1)+' preset loaded')}

function themeToJSON(){
  const w=v=>[v];
  const brand=colors.brand;
  const builtSC={
    ANDROID_NAVIGATION_BAR_BACKGROUND:w(colors.bgTertiary),
    ANDROID_NAVIGATION_SCRIM_BACKGROUND:w(colors.bgTertiary+"80"),
    ANDROID_RIPPLE:w(colors.ripple),
    APP_MESSAGE_EMBED_SECONDARY_TEXT:w(colors.text+"b3"),
    BACKGROUND_ACCENT:w(brand),
    BACKGROUND_BASE_LOW:w(colors.bgSecondary),
    BACKGROUND_BASE_LOWER:w(colors.bgPrimary),
    BACKGROUND_BASE_LOWEST:w(colors.bgTertiary),
    BACKGROUND_BRAND:w(brand),
    BACKGROUND_FEEDBACK_CRITICAL:w(colors.danger),
    BACKGROUND_FEEDBACK_INFO:w(brand+"14"),
    BACKGROUND_FEEDBACK_NOTIFICATION:w(colors.danger),
    BACKGROUND_FEEDBACK_POSITIVE:w(colors.success+"14"),
    BACKGROUND_FEEDBACK_WARNING:w(colors.warning+"1a"),
    BACKGROUND_FLOATING:w(colors.bgFloating),
    BACKGROUND_MENTIONED:w(brand+"33"),
    BACKGROUND_MENTIONED_HOVER:w(brand+"4d"),
    BACKGROUND_MESSAGE_HOVER:w(colors.bgTertiary+"0f"),
    BACKGROUND_MOBILE_PRIMARY:w(colors.bgPrimary),
    BACKGROUND_MOBILE_SECONDARY:w(colors.bgSecondary),
    BACKGROUND_MOD_MUTED:w(colors.muted+"4d"),
    BACKGROUND_MOD_NORMAL:w(colors.muted+"29"),
    BACKGROUND_MOD_STRONG:w(colors.muted+"8a"),
    BACKGROUND_MOD_SUBTLE:w(colors.muted+"7a"),
    BACKGROUND_MODIFIER_ACCENT:w(brand+"26"),
    BACKGROUND_MODIFIER_ACTIVE:w(brand+"33"),
    BACKGROUND_MODIFIER_HOVER:w(brand+"1a"),
    BACKGROUND_MODIFIER_SELECTED:w(brand+"99"),
    BACKGROUND_MODIFIER_ACCEPT:w(colors.success+"33"),
    BACKGROUND_MODIFIER_ACCEPT_HOVER:w(colors.success+"4d"),
    BACKGROUND_NESTED_FLOATING:w(colors.bgNested),
    BACKGROUND_PRIMARY:w(colors.bgPrimary),
    BACKGROUND_SCRIM:w("#000000b3"),
    BACKGROUND_SCRIM_LIGHTBOX:w("#000000eb"),
    BACKGROUND_SECONDARY:w(colors.bgSecondary),
    BACKGROUND_SECONDARY_ALT:w(colors.bgAlt),
    BACKGROUND_SURFACE_HIGH:w(colors.bgTertiary),
    BACKGROUND_SURFACE_HIGHEST:w(colors.bgTertiary),
    BACKGROUND_TERTIARY:w(colors.bgTertiary),
    BADGE_BACKGROUND_BRAND:w(brand),
    BADGE_BACKGROUND_DEFAULT:w(colors.muted+"29"),
    BADGE_NOTIFICATION_BACKGROUND:w(colors.danger),
    BADGE_TEXT_DEFAULT:w(colors.textPrimary),
    BG_BACKDROP:w(colors.bgPrimary+"cc"),
    BG_BASE_PRIMARY:w(colors.bgPrimary),
    BG_BASE_SECONDARY:w(colors.bgSecondary),
    BG_BASE_TERTIARY:w(colors.bgTertiary),
    BG_MOD_FAINT:w(colors.textPrimary+"1a"),
    BG_MOD_SUBTLE:w(colors.textPrimary+"0a"),
    BG_SURFACE_OVERLAY:w(colors.bgFloating),
    BG_SURFACE_OVERLAY_TMP:w(colors.bgPrimary),
    BG_SURFACE_RAISED:w(colors.bgSecondary),
    BLACK:w("#000000"),
    BLUR_FALLBACK:w(colors.bgPrimary+"f5"),
    BLUR_FALLBACK_PRESSED:w(colors.bgTertiary+"f5"),
    BORDER_FEEDBACK_CRITICAL:w(colors.danger+"33"),
    BORDER_FOCUS:w(brand),
    BORDER_FAINT:w(colors.textPrimary+"10"),
    BORDER_MUTED:w("#ffffff08"),
    BORDER_STRONG:w(brand+"55"),
    BORDER_SUBTLE:w(colors.textPrimary+"22"),
    BUG_REPORTER_MODAL_SUBMITTING_BACKGROUND:w(colors.bgFloating),
    BUTTON_DANGER_BACKGROUND_DISABLED:w(colors.danger),
    BUTTON_OUTLINE_BRAND_BACKGROUND_HOVER:w(brand),
    BUTTON_OUTLINE_BRAND_BORDER_ACTIVE:w(colors.brandHover),
    BUTTON_OUTLINE_PRIMARY_TEXT:w("#ffffff"),
    CARD_BACKGROUND_DEFAULT:w(colors.bgSecondary),
    CARD_GRADIENT_BG:w("#00000066"),
    CARD_GRADIENT_PRESSED_BG:w("#00000080"),
    CARD_PRIMARY_BG:w(colors.cardPrimary),
    CARD_PRIMARY_PRESSED_BG:w(colors.bgPrimary),
    CARD_SECONDARY_BG:w(colors.cardSecondary),
    CARD_SECONDARY_PRESSED_BG:w(colors.bgPrimary),
    CHANNEL_ICON:w(colors.icon),
    CHANNELS_DEFAULT:w(colors.textSecond),
    CHANNEL_TEXT_AREA_PLACEHOLDER:w(colors.muted),
    CHANNELTEXTAREA_BACKGROUND:w(colors.input),
    CHAT_BACKGROUND:w("transparent"),
    CHAT_BANNER_BG:w(colors.bgPrimary),
    CHAT_BORDER:w(colors.bgPrimary),
    CHAT_INPUT_CONTAINER_BACKGROUND:w(colors.bgPrimary),
    CHAT_SWIPE_TO_REPLY_BACKGROUND:w(colors.bgFloating),
    CONTENT_INVENTORY_OVERLAY_TEXT_PRIMARY:w(colors.textPrimary+"d9"),
    CONTENT_INVENTORY_OVERLAY_TEXT_SECONDARY:w(colors.textPrimary+"b3"),
    CONTEXT_MENU_BACKDROP_BACKGROUND:w("#000000b3"),
    CONTROL_BRAND_FOREGROUND:w(brand),
    CONTROL_BRAND_FOREGROUND_NEW:w(brand),
    CONTROL_CONNECTED_BACKGROUND_DEFAULT:w(colors.success),
    CONTROL_CONNECTED_BORDER_DEFAULT:w(colors.success),
    CONTROL_CRITICAL_PRIMARY_BACKGROUND_DEFAULT:w(colors.danger),
    CONTROL_CRITICAL_PRIMARY_TEXT_DEFAULT:w("#ffffff"),
    CONTROL_PRIMARY_BACKGROUND_DEFAULT:w(brand),
    CONTROL_PRIMARY_TEXT_DEFAULT:w("#ffffff"),
    CONTROL_SECONDARY_BACKGROUND_ACTIVE:w(colors.muted),
    CONTROL_SECONDARY_BACKGROUND_DEFAULT:w(colors.iconMuted),
    CONTROL_SECONDARY_BORDER_DEFAULT:w(brand),
    CONTROL_SECONDARY_TEXT_DEFAULT:w("#ffffff"),
    CUSTOM_STATUS_BUBBLE_BG:w(colors.bgTertiary),
    DEPRECATED_CARD_BG:w(colors.cardPrimary),
    DEPRECATED_CARD_EDITABLE_BG:w(colors.cardSecondary),
    DEPRECATED_QUICKSWITCHER_INPUT_BACKGROUND:w(colors.input),
    DEPRECATED_QUICKSWITCHER_INPUT_PLACEHOLDER:w(colors.muted),
    DEPRECATED_STORE_BG:w(colors.bgPrimary),
    DEPRECATED_TEXT_INPUT_BG:w(colors.input),
    DEPRECATED_TEXT_INPUT_BORDER:w(colors.bgAlt),
    DEPRECATED_TEXT_INPUT_BORDER_DISABLED:w(colors.bgSecondary),
    DEPRECATED_TEXT_INPUT_BORDER_HOVER:w(brand),
    DEPRECATED_TEXT_INPUT_PREFIX:w(colors.muted),
    ELEVATION_HIGH:w(colors.bgFloating),
    ELEVATION_LOW:w(colors.bgFloating),
    ELEVATION_MEDIUM:w(colors.bgFloating),
    ELEVATION_STROKE:w(colors.muted),
    EMBED_BACKGROUND:w(colors.cardPrimary),
    EMBED_BACKGROUND_ALTERNATE:w(colors.cardSecondary),
    EXPRESSION_PICKER_BG:w(colors.bgFloating),
    FOCUS_PRIMARY:w(brand),
    GUILD_HEADER_TEXT_SHADOW:w(colors.bgTertiary+"88"),
    GUILD_NOTIFICATIONS_BOTTOM_SHEET_PILL_BACKGROUND:w(colors.bgPrimary),
    GUILD_PROFILE_BANNER_BACKGROUND_DEFAULT:w(colors.bgTertiary),
    HEADER_PRIMARY:w(colors.textPrimary),
    HEADER_SECONDARY:w(colors.textSecond),
    HOME_BACKGROUND:w(colors.bgPrimary),
    ICON_FEEDBACK_CRITICAL:w(colors.danger),
    ICON_FEEDBACK_INFO:w(brand),
    ICON_FEEDBACK_NOTIFICATION:w(colors.danger),
    ICON_FEEDBACK_POSITIVE:w(colors.success),
    ICON_FEEDBACK_WARNING:w(colors.warning),
    ICON_MUTED:w(colors.iconMuted),
    ICON_OVERLAY_DARK:w("#2f3035"),
    ICON_OVERLAY_LIGHT:w("#ffffff"),
    ICON_STATUS_DND:w(colors.danger),
    ICON_STATUS_IDLE:w(colors.warning),
    ICON_STATUS_OFFLINE:w(colors.muted),
    ICON_STATUS_ONLINE:w(colors.success),
    ICON_STRONG:w(colors.textPrimary),
    ICON_SUBTLE:w(colors.muted),
    ICON_TRANSPARENT:w("#00000000"),
    ICON_VOICE_MUTED:w(colors.danger),
    INFO_DANGER_BACKGROUND:w(colors.bgFloating),
    INFO_DANGER_FOREGROUND:w(colors.bgPrimary),
    INFO_DANGER_TEXT:w(colors.danger),
    INFO_HELP_BACKGROUND:w(colors.bgFloating),
    INFO_HELP_FOREGROUND:w(colors.bgPrimary),
    INFO_HELP_TEXT:w(colors.textPrimary),
    INFO_POSITIVE_BACKGROUND:w(colors.bgFloating),
    INFO_POSITIVE_FOREGROUND:w(colors.bgPrimary),
    INFO_POSITIVE_TEXT:w(colors.textPrimary),
    INFO_WARNING_BACKGROUND:w(colors.bgFloating),
    INFO_WARNING_FOREGROUND:w(colors.bgPrimary),
    INFO_WARNING_TEXT:w(colors.textPrimary),
    INPUT_BACKGROUND:w(colors.input),
    INPUT_BACKGROUND_DEFAULT:w(colors.bgPrimary),
    INPUT_BORDER_DEFAULT:w(colors.iconMuted+"52"),
    INPUT_PLACEHOLDER_TEXT_DEFAULT:w(colors.muted),
    INPUT_TEXT_DEFAULT:w(colors.textPrimary),
    INPUT_TEXT_ERROR_DEFAULT:w(colors.textPrimary),
    INTERACTIVE_ACTIVE:w(colors.textPrimary),
    INTERACTIVE_BACKGROUND_ACTIVE:w(colors.iconMuted+"7a"),
    INTERACTIVE_BACKGROUND_HOVER:w(colors.iconMuted+"4d"),
    INTERACTIVE_BACKGROUND_SELECTED:w(colors.iconMuted+"99"),
    INTERACTIVE_HOVER:w(brand),
    INTERACTIVE_ICON_ACTIVE:w("#ffffff"),
    INTERACTIVE_ICON_DEFAULT:w(colors.muted),
    INTERACTIVE_ICON_HOVER:w(colors.textPrimary),
    INTERACTIVE_MUTED:w(colors.iconMuted),
    INTERACTIVE_NORMAL:w(colors.icon),
    INTERACTIVE_TEXT_ACTIVE:w("#ffffff"),
    INTERACTIVE_TEXT_DEFAULT:w(colors.muted),
    INTERACTIVE_TEXT_HOVER:w(colors.textPrimary),
    KEYBOARD:w(colors.input),
    LEGACY_ANDROID_BLUR_OVERLAY_DEFAULT:w(colors.bgTertiary+"80"),
    LEGACY_ANDROID_BLUR_OVERLAY_ULTRA_THIN:w("#00000006"),
    LEGACY_BLUR_FALLBACK_DEFAULT:w(colors.bgTertiary+"f9"),
    LEGACY_BLUR_FALLBACK_ULTRA_THIN:w("#000000f2"),
    LOGO_PRIMARY:w(brand),
    MENTION_BACKGROUND:w(brand+"33"),
    MENTION_BADGE:w(colors.danger),
    MENTION_FOREGROUND:w(brand),
    MESSAGE_AUTOMOD_BACKGROUND_DEFAULT:w(colors.danger+"0d"),
    MESSAGE_AUTOMOD_BACKGROUND_HOVER:w(colors.danger+"1a"),
    MESSAGE_BACKGROUND_HOVER:w(colors.bgTertiary+"0f"),
    MESSAGE_HIGHLIGHT_BACKGROUND_DEFAULT:w(brand+"14"),
    MESSAGE_HIGHLIGHT_BACKGROUND_HOVER:w(brand+"0f"),
    MESSAGE_MENTIONED_BACKGROUND_DEFAULT:w(colors.warning+"1a"),
    MESSAGE_MENTIONED_BACKGROUND_HOVER:w(colors.warning+"14"),
    MESSAGE_REACTED_BACKGROUND_DEFAULT:w(brand+"26"),
    MESSAGE_REACTED_TEXT_DEFAULT:w(colors.textPrimary),
    MOBILE_ACTIONSHEET_GRADIENT_BACKGROUND_DEFAULT:w(colors.bgPrimary),
    MOBILE_ALERT_BACKGROUND_DEFAULT:w(colors.bgSecondary),
    MOBILE_ANDROID_BUTTON_BACKGROUND_RIPPLE:w("#ffffff12"),
    MOBILE_BACKGROUND_SCRIM_OPAQUE:w("#000000"),
    MOBILE_COACHMARK_BACKGROUND_DEFAULT:w(colors.bgTertiary),
    MOBILE_EXPRESSION_PICKER_BACKGROUND_DEFAULT:w(colors.bgPrimary),
    MOBILE_TEXT_HEADING_PRIMARY:w(colors.textPrimary),
    MOBILE_TOAST_BACKGROUND_DEFAULT:w(colors.bgTertiary),
    MOBILE_TYPING_INDICATOR_BACKGROUND_DEFAULT:w(colors.bgPrimary),
    MODAL_BACKGROUND:w(colors.bgFloating),
    MODAL_FOOTER_BACKGROUND:w(colors.bgSecondary),
    NAVIGATOR_HEADER_TINT:w("#ffffff"),
    NAV_BAR_BACKGROUND:w(colors.bgSecondary),
    NOTICE_BACKGROUND_POSITIVE:w(colors.success),
    OVERLAY_BACKDROP_LIGHTBOX:w("#000000eb"),
    PANEL_BG:w(colors.bgFloating),
    POLLS_NORMAL_FILL_HOVER:w(colors.cardPrimary),
    POLLS_NORMAL_IMAGE_BACKGROUND:w(colors.bgTertiary),
    POLLS_VICTOR_FILL:w(colors.success+"33"),
    POLLS_VOTED_FILL:w(brand+"33"),
    PREMIUM_NITRO_PINK_TEXT:w(brand),
    PROFILE_BODY_BACKGROUND:w(colors.bgPrimary),
    PROFILE_BODY_BACKGROUND_HOVER:w(colors.bgSecondary),
    PROFILE_GRADIENT_NOTE_BACKGROUND:w("#0000004d"),
    PROFILE_GRADIENT_OVERLAY:w("#00000099"),
    PROFILE_GRADIENT_OVERLAY_SYNCED_WITH_USER_THEME:w("#000000cc"),
    PROFILE_GRADIENT_ROLE_PILL_BACKGROUND:w(colors.bgTertiary+"80"),
    PROFILE_GRADIENT_ROLE_PILL_BORDER:w("#ffffff33"),
    PROFILE_GRADIENT_SECTION_BOX:w("#00000073"),
    REDESIGN_ACTIVITY_CARD_BACKGROUND:w(colors.cardPrimary),
    REDESIGN_ACTIVITY_CARD_BACKGROUND_PRESSED:w(colors.cardSecondary),
    REDESIGN_ACTIVITY_CARD_BADGE_ICON:w(colors.muted),
    REDESIGN_BUTTON_ACTIVE_BACKGROUND:w(colors.success),
    REDESIGN_BUTTON_ACTIVE_PRESSED_BACKGROUND:w(colors.brandHover),
    REDESIGN_BUTTON_ACTIVE_TEXT:w("#ffffff"),
    REDESIGN_BUTTON_DANGER_BACKGROUND:w(colors.danger),
    REDESIGN_BUTTON_DESTRUCTIVE_BACKGROUND:w(colors.danger),
    REDESIGN_BUTTON_DESTRUCTIVE_PRESSED_BACKGROUND:w(colors.danger),
    REDESIGN_BUTTON_DESTRUCTIVE_TEXT:w("#ffffff"),
    REDESIGN_BUTTON_OVERLAY_ALPHA_BACKGROUND:w("#0000008a"),
    REDESIGN_BUTTON_OVERLAY_ALPHA_PRESSED_BACKGROUND:w("#000000a3"),
    REDESIGN_BUTTON_OVERLAY_ALPHA_TEXT:w("#ffffff"),
    REDESIGN_BUTTON_POSITIVE_BACKGROUND:w(colors.success),
    REDESIGN_BUTTON_PREMIUM_PRIMARY_PINK_FOR_GRADIENT:w(brand),
    REDESIGN_BUTTON_PREMIUM_PRIMARY_PRESSED_BACKGROUND:w("#0000001a"),
    REDESIGN_BUTTON_PREMIUM_PRIMARY_PURPLE_FOR_GRADIENT:w(colors.brandHover),
    REDESIGN_BUTTON_PREMIUM_PRIMARY_PURPLE_FOR_GRADIENT_2:w(colors.brandHover),
    REDESIGN_BUTTON_PRIMARY_ALT_BORDER:w(brand),
    REDESIGN_BUTTON_PRIMARY_BACKGROUND:w(brand),
    REDESIGN_BUTTON_PRIMARY_OVERLAY_BACKGROUND:w("#ffffff"),
    REDESIGN_BUTTON_PRIMARY_OVERLAY_PRESSED_BACKGROUND:w(colors.textPrimary),
    REDESIGN_BUTTON_PRIMARY_OVERLAY_TEXT:w(colors.bgTertiary),
    REDESIGN_BUTTON_PRIMARY_PRESSED_BACKGROUND:w(colors.brandHover),
    REDESIGN_BUTTON_PRIMARY_TEXT:w("#ffffff"),
    REDESIGN_BUTTON_SECONDARY_BACKGROUND:w(colors.bgAlt),
    REDESIGN_BUTTON_SECONDARY_ALT_BACKGROUND:w(colors.cardSecondary),
    REDESIGN_BUTTON_SECONDARY_BORDER:w("#ffffff14"),
    REDESIGN_BUTTON_SECONDARY_OVERLAY_BACKGROUND:w("#0000008a"),
    REDESIGN_BUTTON_SECONDARY_OVERLAY_PRESSED_BACKGROUND:w("#000000a3"),
    REDESIGN_BUTTON_SECONDARY_OVERLAY_TEXT:w("#ffffff"),
    REDESIGN_BUTTON_SECONDARY_PRESSED_BACKGROUND:w(colors.bgSecondary),
    REDESIGN_BUTTON_SECONDARY_PRESSED_BORDER:w("#00000000"),
    REDESIGN_BUTTON_SECONDARY_TEXT:w(colors.textPrimary),
    REDESIGN_BUTTON_SELECTED_BACKGROUND:w(brand+"3d"),
    REDESIGN_BUTTON_SELECTED_PRESSED_BACKGROUND:w(brand+"47"),
    REDESIGN_BUTTON_SELECTED_TEXT:w(brand),
    REDESIGN_BUTTON_TERTIARY_BACKGROUND:w(colors.bgTertiary),
    REDESIGN_BUTTON_TERTIARY_PRESSED_BACKGROUND:w(colors.bgFloating),
    REDESIGN_BUTTON_TERTIARY_PRESSED_TEXT:w(colors.muted),
    REDESIGN_BUTTON_TERTIARY_TEXT:w(colors.textPrimary),
    REDESIGN_CHANNEL_CATEGORY_NAME_TEXT:w(colors.muted),
    REDESIGN_CHANNEL_NAME_MUTED_TEXT:w(colors.muted),
    REDESIGN_CHANNEL_NAME_TEXT:w(colors.textPrimary),
    REDESIGN_CHAT_INPUT_BACKGROUND:w(colors.input),
    REDESIGN_IMAGE_BUTTON_PRESSED_BACKGROUND:w("#00000014"),
    REDESIGN_INPUT_CONTROL_ACTIVE_BG:w(brand+"26"),
    REDESIGN_INPUT_CONTROL_SELECTED:w(brand),
    REDESIGN_MENTION_BADGE:w(colors.danger),
    SCROLLBAR_AUTO_THUMB:w(colors.scrollbar),
    SCROLLBAR_AUTO_TRACK:w("transparent"),
    SCROLLBAR_THIN_THUMB:w(colors.scrollbar),
    SCROLLBAR_THIN_TRACK:w("transparent"),
    SPINE_DEFAULT:w(brand),
    SPOILER_HIDDEN_BACKGROUND:w(colors.bgPrimary),
    SPOILER_REVEALED_BACKGROUND:w(colors.bgTertiary),
    STAGE_CARD_PILL_BG:w(colors.bgPrimary),
    STATUS_BAR_BACKGROUND:w(colors.bgTertiary),
    STATUS_DANGER:w(colors.danger),
    STATUS_DANGER_BACKGROUND:w(colors.danger),
    STATUS_DANGER_TEXT:w("#FFFFFF"),
    STATUS_DND:w(colors.danger),
    STATUS_IDLE:w(colors.warning),
    STATUS_OFFLINE:w(colors.muted),
    STATUS_ONLINE:w(colors.success),
    STATUS_POSITIVE:w(colors.success),
    STATUS_POSITIVE_BACKGROUND:w(colors.success),
    STATUS_POSITIVE_TEXT:w("#FFFFFF"),
    STATUS_SPEAKING:w(colors.success),
    STATUS_WARNING:w(colors.warning),
    STATUS_WARNING_BACKGROUND:w(colors.warning),
    STATUS_WARNING_TEXT:w("#000000"),
    TEXT_BRAND:w(brand),
    TEXT_DANGER:w(colors.danger),
    TEXT_DEFAULT:w(colors.textPrimary),
    TEXT_FEEDBACK_CRITICAL:w(colors.danger),
    TEXT_FEEDBACK_INFO:w(brand),
    TEXT_FEEDBACK_POSITIVE:w(colors.success),
    TEXT_FEEDBACK_WARNING:w(colors.warning),
    TEXT_LINK:w(colors.link),
    TEXT_LINK_LOW_SATURATION:w(colors.muted),
    TEXT_MENTION:w(brand),
    TEXT_MUTED:w(colors.muted),
    TEXT_NORMAL:w(colors.text),
    TEXT_OVERLAY_DARK:w("#2f3035"),
    TEXT_OVERLAY_LIGHT:w("#ffffff"),
    TEXT_POSITIVE:w(colors.success),
    TEXT_PRIMARY:w(colors.textPrimary),
    TEXT_SECONDARY:w(colors.textSecond),
    TEXT_STATUS_DND:w(colors.danger),
    TEXT_STATUS_IDLE:w(colors.warning),
    TEXT_STATUS_OFFLINE:w(colors.muted),
    TEXT_STATUS_ONLINE:w(colors.success),
    TEXT_STRONG:w(colors.textPrimary),
    TEXT_SUBTLE:w(colors.muted),
    TEXT_WARNING:w(colors.warning),
    TEXTBOX_MARKDOWN_SYNTAX:w(brand),
    THEME_LOCKED_BLUR_FALLBACK:w(colors.bgPrimary+"f5"),
    THREAD_CHANNEL_SPINE:w(colors.muted+"44"),
    TYPING_INDICATOR_BG:w("#00000066"),
    VOICE_VIDEO_VIDEO_TILE_BACKGROUND:w(colors.bgFloating+"66"),
    VOICE_VIDEO_VIDEO_TILE_BLUR_FALLBACK:w(colors.bgPrimary+"7a"),
    WHITE:w("#ffffff"),
    AUTOCOMPLETE_BG:w(colors.cardPrimary),
    AUTOMOD_QUEUED_FOR_REVIEW_BACKGROUND:w(colors.warning+"33"),
    AUTOMOD_QUEUED_FOR_REVIEW_BACKGROUND_HOVER:w(colors.warning+"4d"),
    ACTIVITY_CARD_BACKGROUND:w(colors.cardPrimary),
    GRADIENT_PROGRESS_PILL_BACKGROUND:w(colors.muted)
  };
  const finalSC=Object.assign({},themeExtra.semanticColors,builtSC);

  const builtRC={
    BG_GRADIENT_CRIMSON_MOON_2:"#000000",
    PRIMARY_100:colors.textPrimary,
    PRIMARY_130:colors.textPrimary,
    PRIMARY_200:colors.textSecond,
    PRIMARY_230:colors.textSecond,
    PRIMARY_300:colors.text,
    PRIMARY_330:colors.text,
    PRIMARY_360:colors.text,
    PRIMARY_400:colors.muted,
    PRIMARY_460:colors.input,
    PRIMARY_500:colors.bgAlt,
    PRIMARY_530:colors.bgAlt,
    PRIMARY_560:colors.scrollbar,
    PRIMARY_600:colors.bgSecondary,
    PRIMARY_630:colors.bgPrimary,
    PRIMARY_660:colors.bgPrimary,
    PRIMARY_700:brand,
    PRIMARY_800:colors.bgTertiary,
    PRIMARY_900:colors.bgFloating,
    BLACK_500:"#000000",
    BLACK_530:"#000000",
    BLACK_560:"#000000",
    BLACK_600:"#000000",
    BLACK_630:"#000000",
    BLACK_660:"#000000",
    BLACK_700:"#000000",
    BLACK_730:"#000000",
    BLACK_760:"#000000",
    BLACK_800:"#000000",
    BLACK_830:"#000000",
    BLACK_860:"#000000",
    BLACK_900:"#000000",
    BRAND_230:colors.textPrimary,
    BRAND_260:brand,
    BRAND_360:brand,
    BRAND_500:brand,
    BRAND_560:colors.brandHover,
    BRAND_600:colors.brandHover,
    BLUE_500:brand,
    RED_400:colors.danger,
    RED_430:colors.danger,
    RED_460:colors.danger,
    RED_500:colors.danger,
    GREEN_360:colors.success,
    WHITE_500:colors.textPrimary,
    YELLOW_260:brand,
    YELLOW_300:colors.warning,
    ORANGE_345:brand,
    LOL_TEXT_LIGHT:brand,
    LOL_TEXT_DARK:brand,
    PLUM_1:colors.textPrimary,
    PLUM_3:brand,
    PLUM_4:colors.textPrimary,
    PLUM_6:colors.textPrimary,
    PLUM_9:colors.muted,
    PLUM_10:colors.muted,
    PLUM_11:colors.bgTertiary,
    PLUM_13:colors.bgPrimary,
    PLUM_15:colors.bgPrimary,
    PLUM_16:colors.bgPrimary,
    PLUM_17:colors.bgTertiary,
    PLUM_18:colors.bgTertiary,
    PLUM_19:colors.bgPrimary,
    PLUM_20:colors.bgTertiary,
    PLUM_22:colors.bgTertiary,
    PLUM_23:colors.bgPrimary,
    PLUM_24:colors.bgPrimary,
    PLUM_25:colors.bgPrimary,
    BADGE_BACKGROUND_DEFAULT_DARK:colors.iconMuted+"29",
    BADGE_BACKGROUND_DEFAULT_DARKER:colors.scrollbar+"29",
    BADGE_BACKGROUND_DEFAULT_LIGHT:colors.muted+"29",
    BADGE_BACKGROUND_DEFAULT_MIDNIGHT:colors.scrollbar+"33",
    BADGE_TEXT_DEFAULT_DARK:colors.textPrimary,
    BADGE_TEXT_DEFAULT_DARKER:brand,
    BADGE_TEXT_DEFAULT_LIGHT:colors.bgTertiary,
    BADGE_TEXT_DEFAULT_MIDNIGHT:colors.textPrimary
  };
  const finalRC=Object.assign({},themeExtra.rawColors,builtRC);

  const plusSection={};
  if(themeExtra.plus.version!=null)plusSection.version=themeExtra.plus.version;
  if(themeExtra.plus.iconPack)plusSection.iconPack=themeExtra.plus.iconPack;
  plusSection.mentionLineColor=colors.mentionLine;
  if(themeExtra.plus.customOverlays)plusSection.customOverlays=true;
  if(themeExtra.plus.icons&&Object.keys(themeExtra.plus.icons).length>0)plusSection.icons={...themeExtra.plus.icons};
  // Merge any other plus keys from import
  const knownPlusKeys=new Set(['version','iconPack','mentionLineColor','customOverlays','icons']);
  for(const[k,v]of Object.entries(themeExtra.plus)){if(!knownPlusKeys.has(k))plusSection[k]=v;}

  const result={
    name:themeMeta.name,
    description:themeMeta.description,
    version:themeMeta.version||"3",
    authors:[{name:themeMeta.authorName,id:themeMeta.authorId}],
    semanticColors:finalSC,
    rawColors:finalRC,
    plus:plusSection,
    spec:themeMeta.spec||2
  };
  // Add background if present
  if(themeExtra.background)result.background=themeExtra.background;
  // Add any other top-level fields
  Object.assign(result,themeExtra.other);
  return JSON.stringify(result,null,2);
}
function copyJSON(){navigator.clipboard.writeText(themeToJSON()).then(()=>showToast('JSON copied!'))}
function downloadJSON(){
  const b=new Blob([themeToJSON()],{type:'application/json'});
  const a=document.createElement('a');a.href=URL.createObjectURL(b);a.download=(themeMeta.name||'theme').replace(/\s+/g,'_')+'.json';a.click();URL.revokeObjectURL(a.href);
}
function openFile(){
  const inp=document.createElement('input');inp.type='file';inp.accept='.json';
  inp.onchange=e=>{
    const f=e.target.files[0];if(!f)return;
    const r=new FileReader();r.onload=()=>{
      try{const o=JSON.parse(r.result);importThemeObj(o);render();showToast('Theme loaded!');
      }catch{showToast('Invalid JSON')}
    };r.readAsText(f);
  };inp.click();
}
function importJSON(){
  const txt=document.getElementById('jsonArea')?.value;if(!txt)return;
  try{const o=JSON.parse(txt);importThemeObj(o);render();showToast('Theme imported!');
  }catch{showToast('Invalid JSON')}
}
function importThemeObj(o){
  // Reset extras
  themeExtra={semanticColors:{},rawColors:{},background:null,plus:{version:"0",iconPack:"",customOverlays:false,icons:{}},other:{}};

  // Mapping from semanticColor keys to internal color keys
  const scMap={
    BACKGROUND_ACCENT:'brand',
    BACKGROUND_PRIMARY:'bgPrimary',BACKGROUND_SECONDARY:'bgSecondary',
    BACKGROUND_SECONDARY_ALT:'bgAlt',BACKGROUND_TERTIARY:'bgTertiary',
    BACKGROUND_FLOATING:'bgFloating',BACKGROUND_NESTED_FLOATING:'bgNested',
    CARD_PRIMARY_BG:'cardPrimary',CARD_SECONDARY_BG:'cardSecondary',
    CHANNELTEXTAREA_BACKGROUND:'input',REDESIGN_CHAT_INPUT_BACKGROUND:'input',
    CHAT_INPUT_CONTAINER_BACKGROUND:'input',
    TEXT_NORMAL:'text',TEXT_MUTED:'muted',
    TEXT_PRIMARY:'textPrimary',HEADER_PRIMARY:'textPrimary',
    TEXT_SECONDARY:'textSecond',HEADER_SECONDARY:'textSecond',
    TEXT_LINK:'link',
    SCROLLBAR_THIN_THUMB:'scrollbar',
    INTERACTIVE_NORMAL:'icon',INTERACTIVE_MUTED:'iconMuted',
    STATUS_DANGER:'danger',STATUS_DND:'danger',
    STATUS_ONLINE:'success',STATUS_POSITIVE:'success',
    STATUS_IDLE:'warning',STATUS_OFFLINE:'muted',
    ANDROID_RIPPLE:'ripple',
    MENTION_BADGE:'danger',
    CHANNEL_ICON:'icon'
  };

  if(o.semanticColors){
    const sc=o.semanticColors;
    for(const[k,v]of Object.entries(sc)){
      const arr=Array.isArray(v)?v:null;
      if(!arr||!arr[0])continue;
      if(scMap[k]){
        colors[scMap[k]]=arr[0];
      }else{
        // Store unmapped keys for round-trip
        themeExtra.semanticColors[k]=arr;
      }
    }
  }

  if(o.rawColors){
    const rcMap={BRAND_500:'brand',RED_500:'danger',PRIMARY_600:'bgPrimary',PRIMARY_700:'bgPrimary',PRIMARY_800:'bgTertiary',PRIMARY_100:'textPrimary'};
    for(const[k,v]of Object.entries(o.rawColors)){
      if(rcMap[k]){
        colors[rcMap[k]]=v;
      }else{
        themeExtra.rawColors[k]=v;
      }
    }
  }

  // Plus section
  if(o.plus){
    themeExtra.plus.version=o.plus.version||"0";
    themeExtra.plus.iconPack=o.plus.iconPack||"";
    themeExtra.plus.customOverlays=!!o.plus.customOverlays;
    if(o.plus.icons)themeExtra.plus.icons={...o.plus.icons};
    if(o.plus.mentionLineColor)colors.mentionLine=o.plus.mentionLineColor;
    // Preserve unknown plus keys
    const knownPK=new Set(['version','iconPack','customOverlays','icons','mentionLineColor']);
    for(const[k,v]of Object.entries(o.plus)){if(!knownPK.has(k))themeExtra.plus[k]=v;}
  }

  // Background
  if(o.background)themeExtra.background=o.background;

  // Meta
  if(o.name)themeMeta.name=o.name;
  if(o.description)themeMeta.description=o.description;
  if(o.version)themeMeta.version=o.version;
  if(o.spec)themeMeta.spec=o.spec;
  if(o.authors&&o.authors[0]){
    themeMeta.authorName=o.authors[0].name||themeMeta.authorName;
    themeMeta.authorId=o.authors[0].id||themeMeta.authorId;
  }

  // Preserve other top-level fields
  const knownKeys=new Set(['name','description','version','authors','semanticColors','rawColors','plus','spec','background']);
  for(const[k,v]of Object.entries(o)){
    if(!knownKeys.has(k))themeExtra.other[k]=v;
  }

  // Also support old flat format
  if(o.colors){
    const c=o.colors;
    if(c.BRAND)colors.brand=c.BRAND;if(c.LINK)colors.link=c.LINK;
    if(c.TEXT_NORMAL)colors.text=c.TEXT_NORMAL;if(c.TEXT_MUTED)colors.muted=c.TEXT_MUTED;
    if(c.HEADER_PRIMARY)colors.textPrimary=c.HEADER_PRIMARY;if(c.HEADER_SECONDARY)colors.textSecond=c.HEADER_SECONDARY;
    if(c.BACKGROUND_PRIMARY)colors.bgPrimary=c.BACKGROUND_PRIMARY;if(c.BACKGROUND_SECONDARY)colors.bgSecondary=c.BACKGROUND_SECONDARY;
    if(c.BACKGROUND_SECONDARY_ALT)colors.bgAlt=c.BACKGROUND_SECONDARY_ALT;if(c.BACKGROUND_TERTIARY)colors.bgTertiary=c.BACKGROUND_TERTIARY;
    if(c.BACKGROUND_FLOATING)colors.bgFloating=c.BACKGROUND_FLOATING;if(c.BACKGROUND_NESTED_FLOATING)colors.bgNested=c.BACKGROUND_NESTED_FLOATING;
    if(c.CARD_PRIMARY_BG)colors.cardPrimary=c.CARD_PRIMARY_BG;if(c.CARD_SECONDARY_BG)colors.cardSecondary=c.CARD_SECONDARY_BG;
  }
}

render();
</script>
</body>
</html>
